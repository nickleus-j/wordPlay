function setupExtDoubleClick(e, t, i, o, n, r) { setupDoubleClick(e, t, o, n, r, function (e, t, i, o) { return e + "search/" + (t ? t + "/" : "") + (i ? "direct/" : "") + "?q=" + o }) } function setupDoubleClick(e, t, i, o, n, r, l) { if (!e || !t) return void alert("Please specify required parameters (websiteUrl and dictionary) to setupDoubleClick()"); var a = function (i) { for (var o = t, r = i.target || i.srcElement; null != r;) { var l = r.getAttribute("dict"); if (l) { o = l; break } if (r.parentNode == r.ownerDocument) break; r = r.parentNode } i.preventDefault(); var a = getSelectedText(); if (a = a.replace(/[\.\*\?;!()\+,\[:\]<>^_`\[\]{}~\\\/\"\'=]/g, " "), a = a.replace(/\s+/g, " "), null != a && a.replace("/s/g", "").length > 0) { if (n && a.split(/[ -]/).length > n) return; if (0 == $("#definition_layer").length) { var u = e + "external/images/doubleclick/definition-layer.gif"; $("body").append("<div id='definition_layer' style='position:absolute; cursor:pointer;'><img src='" + u + "' alt='' title=''/></div>") } $("#definition_layer").map(function () { $(this).css({ left: i.pageX - 30, top: i.pageY - 40 }) }), $("#definition_layer").mouseup(function (e) { e.stopPropagation(), c(a, o) }) } else $("#definition_layer").remove() }, c = function (t, o) { var n; if (n = l ? l(e, o, i, t) : e + "search/" + (o ? o + "/" : "") + (i ? "direct/" : "") + "?q=" + t, r) { if ("self" == r) return void (window.location.href = n); var a = window.open(n, r, "toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=no,copyhistory=no,width=915,height=760,top=300,left=300"); a && a.focus() } else window.open(n, "cup_lookup") }, u = o ? "." + o : "body"; $(u).mouseup(a) } function getSelectedText() { return window.getSelection ? window.getSelection().toString() : document.getSelection ? document.getSelection() : document.selection ? document.selection.createRange().text : "" }